---
import PageLayout from '@/layouts/PageLayout.astro';
import { getFormattedDate } from '@/utils/utils';
import { getCollection } from 'astro:content';

const blogPosts = await getCollection('blog', ({ data }) => {
  return !data.draft && data.publishDate < new Date();
});
---

<PageLayout>
  <div class="px-6 pt-16 pb-20 lg:px-8 lg:pt-24 lg:pb-28">
    <div class="relative mx-auto max-w-lg divide-y-2 divide-slate-200 lg:max-w-7xl">
      <div>
        <h2 class="text-3xl font-bold tracking-tight text-slate-900 dark:text-slate-100 sm:text-4xl">Blog</h2>
        <div class="mt-3 sm:mt-4 lg:grid lg:grid-cols-2 lg:items-center lg:gap-5">
          <p class="text-xl text-slate-500 dark:text-slate-200">Get notified of new posts, only.</p>
          <!-- <form class="mt-6 flex flex-col sm:flex-row lg:mt-0 lg:justify-end">
            <div>
              <label for="email-address" class="sr-only">Email address</label>
              <input
                id="email-address"
                name="email-address"
                type="email"
                autocomplete="email"
                required
                class="w-full appearance-none rounded-md border border-slate-300 bg-white px-4 py-2 text-base text-slate-900 placeholder-slate-500 focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 dark:text-slate-100 lg:max-w-xs"
                placeholder="Enter your email"
              />
            </div>
            <div class="mt-2 flex w-full flex-shrink-0 rounded-md shadow-sm sm:mt-0 sm:ml-3 sm:inline-flex sm:w-auto">
              <button
                type="button"
                class="flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:inline-flex sm:w-auto"
                >Notify me</button
              >
            </div>
          </form> -->
        </div>
      </div>
      <div class="mt-6 grid gap-16 pt-10 lg:grid-cols-2 lg:gap-x-5 lg:gap-y-12">
        {
          blogPosts.map((post) => (
            <div>
              <p class="text-sm text-slate-500">
                <time datetime={post.data.publishDate}>{getFormattedDate(post.data.publishDate)}</time>
              </p>
              <a href={`/blog/${post.slug}`} class="mt-2 block">
                <p class="text-xl font-semibold text-slate-900 dark:text-slate-100">{post.data.title}</p>
                <p class="mt-3 text-base text-slate-500 dark:text-slate-200">{post.data.description}</p>
              </a>
              <div class="mt-3">
                <a href={`/blog/${post.slug}`} class="text-base font-semibold text-indigo-600 hover:text-indigo-500">
                  Read full story
                </a>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</PageLayout>
